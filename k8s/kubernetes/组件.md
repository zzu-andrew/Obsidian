





## `svc`

查看 `svc` 中 集群 `IP` 向 `Endpoint` 的匹配关系
```bash
[root@k8smaster-ims ~]# kubectl describe svc prometheus-k8s -n base-services
Name:                     prometheus-k8s
Namespace:                base-services
Labels:                   app.kubernetes.io/component=prometheus
                          app.kubernetes.io/name=prometheus
                          app.kubernetes.io/part-of=kube-prometheus
                          app.kubernetes.io/version=2.26.0
                          prometheus=k8s
Annotations:              <none>
Selector:                 app.kubernetes.io/component=prometheus,app.kubernetes.io/name=prometheus,app.kubernetes.io/part-of=kube-prometheus,app=prometheus,prometheus=k8s
Type:                     NodePort
IP Family Policy:         SingleStack
IP Families:              IPv4
IP:                       10.96.2.144
IPs:                      10.96.2.144
Port:                     web  9090/TCP
TargetPort:               9090/TCP
NodePort:                 web  30090/TCP
Endpoints:                100.66.218.147:9090
Session Affinity:         ClientIP
External Traffic Policy:  Cluster
Events:                   <none>
```



### `pvc`


```yaml
apiVersion: v1
kind: PersistentVolume
metadata:
  name: prometheus-storage-pv
  namespace: base-services
spec:
  storageClassName: prometheus-db-vol
  persistentVolumeReclaimPolicy: Retain
  capacity:
    storage: 30Gi
  accessModes:
    - ReadWriteOnce
  hostPath:
    path: /opt/prometheus
---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: prometheus-db
  namespace: base-services
spec:
  storageClassName: prometheus-db-vol
  accessModes:
    - ReadWriteOnce
  resources:
    requests:
      storage: 1Gi
```

Pod中的使用
```yaml
spec:
  replicas: 2
  volumes:
    - name: prometheus-pv-storage
      persistentVolumeClaim:
        claimName: prometheus-db
  containers:
  - name: prometheus
    volumeMounts:
    - name: prometheus-pv-storage
      mountPath: /prometheus
```